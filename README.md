# YouTube ハッシュタグトラッカー

このプロジェクトは、特定のハッシュタグ（例: `#安野たかひろ`、`#チームみらい`）が付いたYouTube動画を自動的に収集し、Google スプレッドシートに記録するGoogle Apps Scriptです。

## 機能

- YouTube Data APIを使用して、指定したハッシュタグが付いた動画を検索
- 動画の詳細情報（タイトル、URL、チャンネル情報、統計情報など）を取得
- 取得したデータをGoogle スプレッドシートに自動的に記録
- 重複する動画を自動的に排除（最新のデータを保持）

## セットアップ手順

### 1. 必要なツールのインストール

以下のツールをインストールしてください：

- [Node.js](https://nodejs.org/) (v23.6.0以上)
- [clasp](https://github.com/google/clasp) (Google Apps Scriptのコマンドラインツール)

```bash
npm install -g @google/clasp
```

### 2. プロジェクトのセットアップ

1. リポジトリをクローンします。
2. プロジェクトのルートディレクトリで以下のコマンドを実行して依存関係をインストールします：

```bash
npm install
```

### 3. Google Cloud Platform プロジェクトの設定

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセスします。
2. 新しいプロジェクトを作成します。
3. 以下のAPIを有効にします：
   - YouTube Data API v3
   - Google Sheets API
4. 「認証情報」→「認証情報を作成」→「サービスアカウント」を選択し、新しいサービスアカウントを作成します。
5. サービスアカウントのキーをJSON形式でダウンロードし、プロジェクトのルートディレクトリに `credentials.json` として保存します。

### 4. Google Apps Script プロジェクトの作成と設定

1. ターミナルで以下のコマンドを実行してログインします：

```bash
clasp login
```

2. 新しいGoogle Apps Scriptプロジェクトを作成します：

```bash
clasp create --type sheets --title "YouTubeハッシュタグトラッカー" --rootDir ./src
```

3. `.clasp.json` ファイルが生成されるので、必要に応じて編集します。

### 5. スクリプトのデプロイ

1. 以下のコマンドでスクリプトをアップロードします：

```bash
npm run push
```

2. 初回デプロイを行います：

```bash
npm run deploy
```

### 6. スプレッドシートの設定

1. スクリプトエディタで `appsscript.json` を開き、`SPREADSHEET_ID` を設定します。
   - 既存のスプレッドシートを使用する場合は、そのIDを指定します。
   - 新規作成する場合は、空のままにします。

### 7. トリガーの設定

1. スクリプトエディタで「編集」→「現在のプロジェクトのトリガー」を選択します。
2. 「トリガーを追加」をクリックし、以下のように設定します：
   - 実行する関数: `main`
   - 実行するデプロイ: `Head`
   - イベントのソース: `時間主導型`
   - 時間ベースのトリガーのタイプ: `日付ベースのタイマー`
   - 時間の間隔: `1日ごと` (または任意の間隔)

## 使い方

1. スクリプトを初めて実行すると、新しいスプレッドシートが作成されます（`SPREADSHEET_ID` が設定されていない場合）。
2. スプレッドシートには、指定したハッシュタグが付いた動画の情報が自動的に記録されます。
3. 各列には以下の情報が含まれます：
   - 取得日時
   - ハッシュタグ
   - 動画ID
   - 動画タイトル
   - 動画URL
   - チャンネル名
   - チャンネル登録者数
   - 動画公開日
   - 動画の説明
   - 視聴回数
   - いいね数
   - 低評価数
   - コメント数
   - 動画URL（クリック可能なリンク）

## カスタマイズ

### ハッシュタグの変更

`src/index.ts` の `TARGET_HASHTAGS` 配列を編集して、追跡するハッシュタグを変更できます。

```typescript
const TARGET_HASHTAGS = ['#安野たかひろ', '#チームみらい', '#追加のハッシュタグ'];
```

### スプレッドシートの設定

`SPREADSHEET_ID` を変更することで、既存のスプレッドシートを使用するように設定できます。

## 注意事項

- YouTube Data APIには1日あたりのクォータ制限があります。大量の動画を取得する場合は注意してください。
- スクリプトの実行には数分かかる場合があります。
- 初回実行時は、YouTube Data APIとGoogle Sheets APIが有効になっていることを確認してください。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルを参照してください。
